<?xml version="1.0"?>

<tool name="CDS_search" id="cds_search" version="1.0">

	<description>
		ORF and CDS search
	</description>

	<macros>
		<import>macros.xml</import>
	</macros>

	<requirements>
		<expand macro="python_required" />
	</requirements>

  	<command><![CDATA[
        #set $infiles = ""
        #for $input in $inputs
            ln -s '$input' '$input.element_identifier';
            #set $infiles = $infiles + $input.element_identifier + ","
        #end for
        #set $infiles = $infiles[:-1]

        python $__tool_directory__/scripts/S01_find_orf_on_multiple_alignment.py
        $infiles
        $__tool_directory__/scripts/code_universel_modified.txt
        $length.min_length_seq
        > '$log' &&

        python $__tool_directory__/scripts/S02_remove_too_short_bit_or_whole_sequence.py
        $nb_species_keep
        $methionine
        $length.min_length_seq
        $length.min_length_subseq
        >> '$log' &&

        python $__tool_directory__/scripts/S03_remove_site_with_not_enough_species_represented.py
        $nb_species_keep
        $length.min_length_nuc
        >> '$log';
    ]]></command>

 	<inputs>
        <param name="inputs" type="data" format="fasta" multiple="true" label="Input files" help="Only a fasta file with nucleic align sequences" />
		<!-- <param name="code_file" type="data" format="txt" label="Choose your file containing the universal code (codons and their amino acids)" /> -->

		<param name="nb_species_keep" type="integer" value="10" min="2" label="Minimal number of species in each locus" help="If you want to remove all the indels the maximum number of species is required" />

        <param name="methionine" type="boolean" checked="true" truevalue="oui" falsevalue="non" label="Do you want to consider the Methionine in the search of CDS? " />

        <section name="length" title="Do you want to choose the minimum length of the CDS?">
            <param name="min_length_seq" type="integer" value="50" min="0" label="Minimal length of the CDS, in proteic" help="By default it's 50" />
            <param name="min_length_subseq" type="integer" value="15" min="0" label="Minimal length of the subsequence, in proteic between two series of indels" help="By default it's 15" />
            <param name="min_length_nuc" type="integer" value="50" min="0" label="Minimal length of the CDS, in nucleic without the indel" help="By default it's 50" />
        </section>

		<param name="out_BESTORF" type="select" label="Do you want the output zip containing files with the BEST ORF? ">
			<option value="no">No</option>
			<option value="aa">Yes, with the proteic format</option>
			<option value="nuc">Yes, with the nucleic format</option>
			<option value="both">Yes, with the proteic and nucleic format</option>
		</param>

		<param name="out_CDS" type="select" label="Do you want the output zip containing files with CDS? ">
			<option value="no">No</option>
			<option value="aa">Yes, with the proteic format</option>
			<option value="nuc">Yes, with the nucleic format</option>
			<option value="both">Yes, with the proteic and nucleic format</option>
		</param>

		<param name="out_CDS_filter" type="select" label="Do you want the output zip containing files with CDS without indel? ">
			<option value="no">No</option>
			<option value="aa">Yes, with the proteic format</option>
			<option value="nuc">Yes, with the nucleic format</option>
			<option value="both">Yes, with the proteic and nucleic format</option>
		</param>
	</inputs>

	<outputs>
		<data format="text" name="log" label="ORF_Search" />
        <collection name="output_BESTORF_aa" type="list" label="ORF_Search_Best_ORF_aa">
            <filter>out_BESTORF in ["aa","both"]</filter>
            <discover_datasets pattern="__name_and_ext__" directory="04_BEST_ORF_aa" />
        </collection>

        <collection name="output_BESTORF_nuc" type="list" label="ORF_Search_Best_ORF_nuc">
            <filter>out_BESTORF in ["nuc","both"]</filter>
            <discover_datasets pattern="__name_and_ext__" directory="04_BEST_ORF_nuc" />
        </collection>

        <collection name="output_CDS_aa" type="list" label="ORF_Search_CDS_aa">
            <filter>out_CDS in ["aa","both"] and not methionine</filter>
            <discover_datasets pattern="__name_and_ext__" directory="05_CDS_aa" />
        </collection>

        <collection name="output_CDS_nuc" type="list" label="ORF_Search_CDS_nuc">
            <filter>out_CDS in ["nuc","both"] and not methionine</filter>
            <discover_datasets pattern="__name_and_ext__" directory="05_CDS_nuc" />
        </collection>

        <collection name="output_CDS_M_aa" type="list" label="ORF_Search_CDS_with_M_aa">
            <filter>(out_CDS == "aa" and methionine) or (out_CDS == "both" and methionine)</filter>
            <discover_datasets pattern="__name_and_ext__" directory="06_CDS_with_M_aa" />
        </collection>

        <collection name="output_CDS_M_nuc" type="list" label="ORF_Search_CDS_with_M_nuc">
            <filter>(out_CDS == "nuc" and methionine) or (out_CDS == "both" and methionine)</filter>
            <discover_datasets pattern="__name_and_ext__" directory="06_CDS_with_M_nuc" />
        </collection>

        <collection name="output_filter_aa" type="list" label="ORF_Search_CDS_without_indel_aa">
            <filter>out_CDS_filter in ["aa","both"]</filter>
            <discover_datasets pattern="__name_and_ext__" directory="08_CDS_aa_MINIMUM_MISSING_SEQUENCES" />
        </collection>

        <collection name="output_filter_nuc" type="list" label="ORF_Search_CDS_without_indel_nuc">
            <filter>out_CDS_filter in ["nuc","both"]</filter>
            <discover_datasets pattern="__name_and_ext__" directory="08_CDS_nuc_MINIMUM_MISSING_SEQUENCES" />
        </collection>
	</outputs>

	<tests>
		<test>
            <param name="inputs" ftype="fasta" value="inputs/locus1_sp5.fasta,inputs/locus1_sp7.fasta,inputs/locus2_sp4.fasta,inputs/locus2_sp6.fasta" />
			<param name="nb_species_keep" value="2" />
			<param name="methionine" value="no" />
            <section name="length">
                <param name="min_length_seq" value="50" />
                <param name="min_length_subseq" value="15" />
                <param name="min_length_nuc" value="50" />
            </section>
			<param name="out_BESTORF" value="both" />
			<param name="out_CDS" value="both" />
			<param name="out_CDS_filter" value="both" />
			<output name="log" value="cds_search.log" />
            <output_collection name="output_BESTORF_aa" type="list">
                <element name="locus1_sp7" value="outputs_ORF_Search_Best_ORF_aa/locus1_sp7.fasta" />
                <element name="locus2_sp6" value="outputs_ORF_Search_Best_ORF_aa/locus2_sp6.fasta" />
            </output_collection>
            <output_collection name="output_BESTORF_nuc" type="list">
                <element name="locus1_sp7" value="outputs_ORF_Search_Best_ORF_nuc/locus1_sp7.fasta" />
                <element name="locus2_sp6" value="outputs_ORF_Search_Best_ORF_nuc/locus2_sp6.fasta" />
            </output_collection>
            <output_collection name="output_CDS_aa" type="list">
                <element name="locus1_sp7" value="outputs_ORF_Search_CDS_aa/locus1_sp7.fasta" />
                <element name="locus2_sp6" value="outputs_ORF_Search_CDS_aa/locus2_sp6.fasta" />
            </output_collection>
            <output_collection name="output_CDS_nuc" type="list">
                <element name="locus1_sp7" value="outputs_ORF_Search_CDS_nuc/locus1_sp7.fasta" />
                <element name="locus2_sp6" value="outputs_ORF_Search_CDS_nuc/locus2_sp6.fasta" />
            </output_collection>
            <output_collection name="output_filter_aa" type="list">
                <element name="locus2_sp4_sp4" value="outputs_ORF_Search_CDS_without_indel_aa/locus2_sp4_sp4.fasta" />
            </output_collection>
            <output_collection name="output_filter_nuc" type="list">
                <element name="locus2_sp4_sp4" value="outputs_ORF_Search_CDS_without_indel_nuc/locus2_sp4_sp4.fasta" />
            </output_collection>
		</test>
        <test>
            <param name="inputs" ftype="fasta" value="inputs/locus2_sp6.fasta" />
			<param name="nb_species_keep" value="2" />
			<param name="methionine" value="yes" />
            <section name="length">
                <param name="min_length_seq" value="50" />
                <param name="min_length_subseq" value="15" />
                <param name="min_length_nuc" value="50" />
            </section>
			<param name="out_BESTORF" value="both" />
			<param name="out_CDS" value="both" />
			<param name="out_CDS_filter" value="both" />
			<output name="log" value="cds_search_methionine.log" />
            <output_collection name="output_BESTORF_aa" type="list">
                <element name="locus2_sp6" value="outputs_ORF_Search_Best_ORF_aa/locus2_sp6.fasta" />
            </output_collection>
            <output_collection name="output_BESTORF_nuc" type="list">
                <element name="locus2_sp6" value="outputs_ORF_Search_Best_ORF_nuc/locus2_sp6.fasta" />
            </output_collection>
            <output_collection name="output_CDS_M_aa" type="list">
                <element name="locus2_sp6" value="outputs_ORF_Search_CDS_with_M_aa/locus2_sp6.fasta" />
            </output_collection>
            <output_collection name="output_CDS_M_nuc" type="list">
                <element name="locus2_sp6" value="outputs_ORF_Search_CDS_with_M_nuc/locus2_sp6.fasta" />
            </output_collection>
		</test>
	</tests>
	<help>
============
What it does
============

| This tool takes **zip file containing fasta files with nucleic aligned sequences** and search the ORF and the CDS
|
| The script in python was written by **Eric Fontanillas**.
| The wrapper was written by **Julie Baffard**.

--------

==========
Parameters
==========

The choice of several parameters is possible.

**min_length_seq**
	| minimal length of the sequence in the proteic format
	| when the removal of the indel is done, the minimal length equals :previous length less20
	| for example if you choose 50 for the minimal length, the actual length equals 30
	|

**min_length_subseq**
	| minimal length of the subsequence in the proteic format
	| subsequence means the part of the original sequence between 2 sets of indels
	| an indel set is composed by more than 2 indels, if not the set is considered as unknown amino acid
	|

**min_length_nuc**
	| Minimal length of the sequence in the nucleic format
	|

--------

======
Inputs
======

option **universal code** :

| the input must have the extension .txt
| It's the file which will serve for the translation of nucleotides to amino acids
| if there are "U"s in this file, they will be automatically transform into "T"s
| for example :
| UUU Phe F
| UCU Ser S
| UAU Tyr Y
| UGU Cys C
| UUC Phe F
| UCC Ser S
| UAC Tyr Y
| UGC Cys C
| UUA Leu L
| UCA Ser S
| UAA Stop *
| ...


--------

=======
Outputs
=======

This tool, produces the following files :

**ORF_Search**
	| is the output with important informations (mainly statistics about the tools).
	|

**ORF_Search_Best_ORF_aa**
	| is the output with the best ORF in the proteic format.
	|

**ORF_Search_Best_ORF_nuc**
	| is the output with the best ORF in the nucleic format.
	|

**ORF_Search_CDS_aa**
	| is the output with the CDS (regardless the Methionine) in the proteic format.
	|

**ORF_Search_CDS_nuc**
	| is the output with the CDS (regardless the Methionine) in the nucleic format.
	|

**ORF_Search_CDS_with_M_aa**
	| is the output with the CDS (considering the Methionine) in proteic format.
	| the rule : they must have a methionine before the minimale length of the sequence.
	| for example before the 30 last amino acid.
	|

**ORF_Search_CDS_with_M_nuc**
	| is the output with the CDS (considering the Methionine) in nucleic format.
	| the rule : they must have a methionine before the minimale length of the sequence.
	| for example before the 30 last amino acid.
	|

**ORF_Search_CDS_without_indel_aa**
	| is the output with the CDS without indel in proteic format.
	| considering the Methionine or not : according to the option chosen.
	|

**ORF_Search_CDS_without_indel_nuc**
	| is the output with the CDS without indel in proteic format.
	| considering the Methionine or not : according to the option chosen.

.. class:: warningmark

The zip outputs have to be downloaded (and extracts the files with a file archiver software), you cannot visualize them with the "eye icon" through the interface.

--------

===============
Working Example
===============

------------------------------
The input file and its options
------------------------------

**ORF_Search**

| a zip file containing 47 files with 1, 2 or 3 sequences inside
| for example the file : locus5_sp3.fasta which contains 3 species :
|

| &gt;Ac533/40375

----------gccccctagcgagtgacgacaaactcg----------------------------------------aacatgttggctgctgggctaagaactctaaaaagccttgcccctcggggttgcgtagcgtggtcgtgtacttcggtgcatgccaagcataccctaccagacttaccatatgattacaatgccctggagccacacatcagtgctgaaatcatgctgctgcatca
caccaagcatcaccagacgtatgtcaacaacctgaatgttgcagaggagaagtttcatgaggctacagagaaaggtgatgtaaccacagcagtatcactgatgccagccctaagatttaatggtggtggacacatcaaccatactatattttggaagaacatgtcaccaaatggtggtggagagccatctggcgaactgatggaggccatcaaacgtgac
tttggctcatttgaaaacatgaagaacatgttgagtacatcaaccactgcagtgcaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactacaggtctcgtcccgttgtttggcatagatgtctgggaacatgcctattacttgcagtacaagaatgttcgtccagact
atgtaaaggctatttggaatgtggccaactgggatgacatcatggaacgttacaacaatgccagaaaataaactgttaaacaaataattaatatattaatgtgttgcaatt-tttgtcaattggtacatacacaattttgttcataaagaaaat--tgtgattactttctg-gcaactagttcccagtgaatacagcaattgttctgccaaggatgcatttggattgagaaggc
acccagaatgggttatccgtgaatgtctattggaatgtggcaccatacgatgtttactgtattagttacaattaaaa-------------------

&gt;Ap401/11000
ctgatgtgtggccccctagcgagtgaagacaaactcgatagcacccagacagttctgttggttagataaaagggagaaacatgctggctgctgggctaagaactctaaaaagccttgctcctcgtggtggtctagcttggtcttgtacctcggtacatgccaaacacacactgccagacttgccgtatgattataatgctctggagccacacatcagtgctgaaa
tcatgttgctgcatcacacaaaacatcaccagacgtatgtgaacaacctgaatattgcagaggagaagtttcatgaggctaccgagaaaggcgatgtgaccacagcagtatcactgatgccagccctaagatttaatggtggtggacatatcaaccatactatattttggaagaacatgtcaccaaatggtggtggagaaccatctggcgaactgatggag
gccatcaaacgtgactttggttcatttgaaaacatgaagaacatgctgagtacagcaaccactgcagtacaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactacaggtcttgtcccactgtttggtatcgatgtctgggaacatgcctattatttacagtacaa
gaatgttcgtccagactatgtaaaggctatttggaatgtggctaactgggatgatatcatggagcgttacaacaatgccagaaaataaac--ttaaatacatcattatttagttaatgtgcgacttttgtttgttaatcagttcacacaccattctattcacaaagaaaatggtgtatttgctttctgttcaactggttcccggtgaatacagcagttgttctgccaaggatgtattt
ggattgagaaggcaccaagaatgggctgtcactgaatgtcaattggaatgtagcctca----atgtttactgtattacctacaattaaaatgattatgatataaccaag

| &gt;Pf2011/1100

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------tgccagatttaccatatgattataatgccttggaaccacacatcagtgctgaaataatgctccttcatcatacaaagcatcaccagacatatgtgaacaatctgaatgt
agctgaagaaaagtttcatgaagccacggagaaaggtgatgtcactacagctgtgtcgctaatgccagcactaagatttaatggcggaggacacatcaatcacaccattttctggaagaacatgtctcctaatggcggaggagagccttctggcgagttgatggaagccattaaacgtgattttggttcatttgagaatatgaaaaacatgttaagtacagcta
caacagctgtccaaggatctggctggggatggcttggttataacaaaaagatgaaaaagctcgagatagccacttgtgccaaccaggatccactggaaggaacaacaggattaattccactgtttggtattgacgtctgggagcatgcttactatctgcaatataaaaatgtacgtccagattatgttaaagctatctggaatgtggccaactgggatgatatta
cagagcgctacaacaatgc-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

**Parameters**

| option : Methionine is considerated
| no option for the CDS's length. So, by default it's min_length_seq : 50, min_length_subseq : 15, min_length_nuc : 50

----------------
The output files
----------------


**ORF_Search_Best_ORF_aa**

|
| *************** CDS detection ***************
|
| Files processed: 47
|
| Files with CDS: 32
| Files with CDS plus M (codon start): 20
| Files without CDS: 15
|
| In locus with CDS considering Methionine :
|
| *************** 1st filter : selection of the locus ***************
|

Total number of locus recorded  = 20

| Number of locus with 1 species : 1
| Number of locus with 2 species : 16
| Number of locus with 3 species : 3
|
| Number of locus excluded (exclude if not at least 3 species in the alignment)= 17
| 
| *************** 2nd Filter : removal of the indel ***************
| 
| Total number of locus recorded  = 3
|

Total number of locus with no indels (SAVED) = 3

Total number of locus with indels (EXCLUDED) = 0

|

**ORF_Search_Best_ORF_aa**

| &gt;Pf2011/1100

?????????????????????????????????????????????????????????PDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNVAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTATTAVQ
GSGWGWLGYNKKMKKLEIATCANQDPLEGTTGLIPLFGIDVWEHAYYLQYKNVRPDYVKAIWNVANWDDITERYNN??????????????????????????????????????????????????????????????????????????????????????????

| &gt;Ap401/11000

DVWPPSE*RQTR*HPDSSVG*IKGRNMLAAGLRTLKSLAPRGGLAWSCTSVHAKHTLPDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNIAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLS
TATTAVQGSGWGWLGYNKKMKKLEIATCANQDPLEGTTGLVPLFGIDVWEHAYYLQYKNVRPDYVKAIWNVANWDDIMERYNNARK*??KYIII*LMCDFCLLISSHTILFTKKMVYLLSVQLVPGEYSSCSAKDVFGLRRHQEWAVTECQLECSL??CLLYYLQLK*
L*YNQ

| &gt;Ac533/40375

???PPSE*RQT??????????????NMLAAGLRTLKSLAPRGCVAWSCTSVHAKHTLPDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNVAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTS
TTAVQGSGWGWLGYNKKMKKLEIATCANQDPLEGTTGLVPLFGIDVWEHAYYLQYKNVRPDYVKAIWNVANWDDIMERYNNARK*TVKQIINILMCCN?LSIGTYTILFIKK??*LLS?QLVPSEYSNCSAKDAFGLRRHPEWVIRECLLECGTIRCLLY*LQLK??????

.. class:: infomark

| Save as *Galaxy{number}-[ORF_Search_Best_ORF_aa].zip*
| If you unzip the file, a number of files are extracted (depends on the number of locus keeped) : locus{nb}_sp{nb_sp}.fasta
| for example : locus5_sp3.fasta
|
| 

**ORF_Search_Best_ORF_nuc**

| &gt;Pf2011/1100

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------tgccagatttaccatatgattataatgccttggaaccacacatcagtgctgaaataatgctccttcatcatacaaagcatcaccagacatatgtgaacaatctgaatgta
gctgaagaaaagtttcatgaagccacggagaaaggtgatgtcactacagctgtgtcgctaatgccagcactaagatttaatggcggaggacacatcaatcacaccattttctggaagaacatgtctcctaatggcggaggagagccttctggcgagttgatggaagccattaaacgtgattttggttcatttgagaatatgaaaaacatgttaagtacagctac
aacagctgtccaaggatctggctggggatggcttggttataacaaaaagatgaaaaagctcgagatagccacttgtgccaaccaggatccactggaaggaacaacaggattaattccactgtttggtattgacgtctgggagcatgcttactatctgcaatataaaaatgtacgtccagattatgttaaagctatctggaatgtggccaactgggatgatattac
agagcgctacaacaatgc----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

| &gt;Ap401/11000

gatgtgtggccccctagcgagtgaagacaaactcgatagcacccagacagttctgttggttagataaaagggagaaacatgctggctgctgggctaagaactctaaaaagccttgctcctcgtggtggtctagcttggtcttgtacctcggtacatgccaaacacacactgccagacttgccgtatgattataatgctctggagccacacatcagtgctgaaatc
atgttgctgcatcacacaaaacatcaccagacgtatgtgaacaacctgaatattgcagaggagaagtttcatgaggctaccgagaaaggcgatgtgaccacagcagtatcactgatgccagccctaagatttaatggtggtggacatatcaaccatactatattttggaagaacatgtcaccaaatggtggtggagaaccatctggcgaactgatggaggc
catcaaacgtgactttggttcatttgaaaacatgaagaacatgctgagtacagcaaccactgcagtacaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactacaggtcttgtcccactgtttggtatcgatgtctgggaacatgcctattatttacagtacaagaa
tgttcgtccagactatgtaaaggctatttggaatgtggctaactgggatgatatcatggagcgttacaacaatgccagaaaataaac--ttaaatacatcattatttagttaatgtgcgacttttgtttgttaatcagttcacacaccattctattcacaaagaaaatggtgtatttgctttctgttcaactggttcccggtgaatacagcagttgttctgccaaggatgtatttggat
tgagaaggcaccaagaatgggctgtcactgaatgtcaattggaatgtagcctca----atgtttactgtattacctacaattaaaatgattatgatataaccaa

| &gt;Ac533/40375

--------gccccctagcgagtgacgacaaactcg----------------------------------------aacatgttggctgctgggctaagaactctaaaaagccttgcccctcggggttgcgtagcgtggtcgtgtacttcggtgcatgccaagcataccctaccagacttaccatatgattacaatgccctggagccacacatcagtgctgaaatcatgctgctgcatcac
accaagcatcaccagacgtatgtcaacaacctgaatgttgcagaggagaagtttcatgaggctacagagaaaggtgatgtaaccacagcagtatcactgatgccagccctaagatttaatggtggtggacacatcaaccatactatattttggaagaacatgtcaccaaatggtggtggagagccatctggcgaactgatggaggccatcaaacgtgact
ttggctcatttgaaaacatgaagaacatgttgagtacatcaaccactgcagtgcaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactacaggtctcgtcccgttgtttggcatagatgtctgggaacatgcctattacttgcagtacaagaatgttcgtccagacta
tgtaaaggctatttggaatgtggccaactgggatgacatcatggaacgttacaacaatgccagaaaataaactgttaaacaaataattaatatattaatgtgttgcaatt-tttgtcaattggtacatacacaattttgttcataaagaaaat--tgtgattactttctg-gcaactagttcccagtgaatacagcaattgttctgccaaggatgcatttggattgagaaggca
cccagaatgggttatccgtgaatgtctattggaatgtggcaccatacgatgtttactgtattagttacaattaaaa------------------

.. class:: infomark

| Save as *Galaxy{number}-[ORF_Search_Best_ORF_nuc].zip*
| If you unzip the file, a number of files are extracted (depends on the number of locus keeped) : locus{nb}_sp{nb_sp}.fasta
| for example : locus5_sp3.fasta
|
|

**ORF_Search_CDS_with_M_aa**

| &gt;Pf2011/1100

????????????????????????????????????PDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNVAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTATTAVQGSGWGWLGYNKKMKK
LEIATCANQDPLEGTTGLIPLFGIDVWEHAYYLQYKNVRPDYVKAIWNVANWDDITERYNN???

| &gt;Ap401/11000

IKGRNMLAAGLRTLKSLAPRGGLAWSCTSVHAKHTLPDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNIAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTATTAVQGSGWGWLGYNK
KMKKLEIATCANQDPLEGTTGLVPLFGIDVWEHAYYLQYKNVRPDYVKAIWNVANWDDIMERYNNARK

| &gt;Ac533/40375

????NMLAAGLRTLKSLAPRGCVAWSCTSVHAKHTLPDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNVAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTSTTAVQGSGWGWLGYNK
KMKKLEIATCANQDPLEGTTGLVPLFGIDVWEHAYYLQYKNVRPDYVKAIWNVANWDDIMERYNNARK

.. class:: infomark

| Save as *Galaxy{number}-[ORF_Search_CDS_with_M_aa].zip*
| If you unzip the file, a number of files are extracted (depends on the number of locus keeped) : locus{nb}_sp{nb_sp}.fasta
| for example : locus5_sp3.fasta

| It's the same for the option : regardless Methionine
|
|

**ORF_Search_CDS_with_M_nuc**

| &gt;Pf2011/1100

----------------------------------------------------------------------------------------------------------tgccagatttaccatatgattataatgccttggaaccacacatcagtgctgaaataatgctccttcatcatacaaagcatcaccagacatatgtgaacaatctgaatgtagctgaagaaaagtttcatgaagccacggagaaaggtgatg
tcactacagctgtgtcgctaatgccagcactaagatttaatggcggaggacacatcaatcacaccattttctggaagaacatgtctcctaatggcggaggagagccttctggcgagttgatggaagccattaaacgtgattttggttcatttgagaatatgaaaaacatgttaagtacagctacaacagctgtccaaggatctggctggggatggcttggttataa
caaaaagatgaaaaagctcgagatagccacttgtgccaaccaggatccactggaaggaacaacaggattaattccactgtttggtattgacgtctgggagcatgcttactatctgcaatataaaaatgtacgtccagattatgttaaagctatctggaatgtggccaactgggatgatattacagagcgctacaacaatgc-------

| &gt;Ap401/11000

ataaaagggagaaacatgctggctgctgggctaagaactctaaaaagccttgctcctcgtggtggtctagcttggtcttgtacctcggtacatgccaaacacacactgccagacttgccgtatgattataatgctctggagccacacatcagtgctgaaatcatgttgctgcatcacacaaaacatcaccagacgtatgtgaacaacctgaatattgcagagga
gaagtttcatgaggctaccgagaaaggcgatgtgaccacagcagtatcactgatgccagccctaagatttaatggtggtggacatatcaaccatactatattttggaagaacatgtcaccaaatggtggtggagaaccatctggcgaactgatggaggccatcaaacgtgactttggttcatttgaaaacatgaagaacatgctgagtacagcaaccactg
cagtacaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactacaggtcttgtcccactgtttggtatcgatgtctgggaacatgcctattatttacagtacaagaatgttcgtccagactatgtaaaggctatttggaatgtggctaactgggatgatatcatggagcg
ttacaacaatgccagaaaa

| &gt;Ac533/40375

------------aacatgttggctgctgggctaagaactctaaaaagccttgcccctcggggttgcgtagcgtggtcgtgtacttcggtgcatgccaagcataccctaccagacttaccatatgattacaatgccctggagccacacatcagtgctgaaatcatgctgctgcatcacaccaagcatcaccagacgtatgtcaacaacctgaatgttgcagaggagaa
gtttcatgaggctacagagaaaggtgatgtaaccacagcagtatcactgatgccagccctaagatttaatggtggtggacacatcaaccatactatattttggaagaacatgtcaccaaatggtggtggagagccatctggcgaactgatggaggccatcaaacgtgactttggctcatttgaaaacatgaagaacatgttgagtacatcaaccactgcagt
gcaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactacaggtctcgtcccgttgtttggcatagatgtctgggaacatgcctattacttgcagtacaagaatgttcgtccagactatgtaaaggctatttggaatgtggccaactgggatgacatcatggaacgtt
acaacaatgccagaaaa

.. class:: infomark

| Save as *Galaxy{number}-[ORF_Search_CDS_nuc].zip*
| if you unzip the file, a number of files are extracted (depends on the number of locus keeped) : locus{nb}_sp{nb_sp}.fasta
| for example : locus5_sp3.fasta
 
| It's the same for the option : regardless Methionine
|
|

**ORF_Search_CDS_without_indel_aa**

| &gt;Pf2011/1100

PDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNVAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTATTAVQGSGWGWLGYNKKMKKLEIATCANQDPLEGTTGLIPLFGIDVWEHAYYLQ
YKNVRPDYVKAIWNVANWDDITERYNN

| &gt;Ap401/11000

PDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNIAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTATTAVQGSGWGWLGYNKKMKKLEIATCANQDPLEGTTGLVPLFGIDVWEHAYYLQ
YKNVRPDYVKAIWNVANWDDIMERYNN

| &gt;Ac533/40375

PDLPYDYNALEPHISAEIMLLHHTKHHQTYVNNLNVAEEKFHEATEKGDVTTAVSLMPALRFNGGGHINHTIFWKNMSPNGGGEPSGELMEAIKRDFGSFENMKNMLSTSTTAVQGSGWGWLGYNKKMKKLEIATCANQDPLEGTTGLVPLFGIDVWEHAYYLQ
YKNVRPDYVKAIWNVANWDDIMERYNN

.. class:: infomark

| Save as *Galaxy{number}-[ORF_Search_CDS_without_indel_aa].zip*
| If you unzip the file, a number of files are extracted (depends on the number of locus keeped) : locus{nb}_sp{old_nb_sp}_sp_{new_nb_sp}.fasta
| for example locus5_sp3_sp3.fasta
|
|

**ORF_Search_CDS_without_indel_nuc**

| &gt;Pf2011/1100

ccagatttaccatatgattataatgccttggaaccacacatcagtgctgaaataatgctccttcatcatacaaagcatcaccagacatatgtgaacaatctgaatgtagctgaagaaaagtttcatgaagccacggagaaaggtgatgtcactacagctgtgtcgctaatgccagcactaagatttaatggcggaggacacatcaatcacaccattttctggaa
gaacatgtctcctaatggcggaggagagccttctggcgagttgatggaagccattaaacgtgattttggttcatttgagaatatgaaaaacatgttaagtacagctacaacagctgtccaaggatctggctggggatggcttggttataacaaaaagatgaaaaagctcgagatagccacttgtgccaaccaggatccactggaaggaacaacaggatta
attccactgtttggtattgacgtctgggagcatgcttactatctgcaatataaaaatgtacgtccagattatgttaaagctatctggaatgtggccaactgggatgatattacagagcgctacaacaat

| &gt;Ap401/11000

ccagacttgccgtatgattataatgctctggagccacacatcagtgctgaaatcatgttgctgcatcacacaaaacatcaccagacgtatgtgaacaacctgaatattgcagaggagaagtttcatgaggctaccgagaaaggcgatgtgaccacagcagtatcactgatgccagccctaagatttaatggtggtggacatatcaaccatactatattttgga
agaacatgtcaccaaatggtggtggagaaccatctggcgaactgatggaggccatcaaacgtgactttggttcatttgaaaacatgaagaacatgctgagtacagcaaccactgcagtacaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactacag
gtcttgtcccactgtttggtatcgatgtctgggaacatgcctattatttacagtacaagaatgttcgtccagactatgtaaaggctatttggaatgtggctaactgggatgatatcatggagcgttacaacaat

| &gt;Ac533/40375

ccagacttaccatatgattacaatgccctggagccacacatcagtgctgaaatcatgctgctgcatcacaccaagcatcaccagacgtatgtcaacaacctgaatgttgcagaggagaagtttcatgaggctacagagaaaggtgatgtaaccacagcagtatcactgatgccagccctaagatttaatggtggtggacacatcaaccatactatattttgg
aagaacatgtcaccaaatggtggtggagagccatctggcgaactgatggaggccatcaaacgtgactttggctcatttgaaaacatgaagaacatgttgagtacatcaaccactgcagtgcaaggctctggctggggatggcttgggtacaataaaaagatgaagaaactagaaattgccacctgtgccaaccaagatccattagagggcactaca
ggtctcgtcccgttgtttggcatagatgtctgggaacatgcctattacttgcagtacaagaatgttcgtccagactatgtaaaggctatttggaatgtggccaactgggatgacatcatggaacgttacaacaat

.. class:: infomark

| Save as *Galaxy{number}-[ORF_Search_CDS_without_indel_nuc].zip*
| If you unzip the file, a number of files are extracted (depends on the number of locus keeped) : locus{nb}_sp{old_nb_sp}_sp_{new_nb_sp}.fasta
| for example : locus5_sp3_sp3.fasta
	</help>

	<expand macro="citations" />

</tool>
